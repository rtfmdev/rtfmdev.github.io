<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; 
font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com https://public.slidesharecdn.com  https://cdn.jsdelivr.net jsdelivr.net jsdelivr.net disqus.com disquscdn.com *.disqus.com *.disquscdn.com; 
form-action 'self' https://syndication.twitter.com/ https://platform.twitter.com disqus.com disquscdn.com *.disqus.com *.disquscdn.com; 
frame-src 'self' https://cse.google.com https://player.vimeo.com www.youtube.com www.youtube-nocookie.com https://platform.twitter.com https://syndication.twitter.com jsfiddle.net www.instagram.com https://kuula.co https://www.slideshare.net https://www.google.com https://googleads.g.doubleclick.net disqus.com disquscdn.com *.disqus.com *.disquscdn.com; 
img-src 'self' https://jeremylikness.visualstudio.com https://www.google-analytics.com https://stats.g.doubleclick.net https://pagead2.googlesyndication.com *.google.com *.gstatic.com *.amazon-adsystem.com https://www.googleapis.com https://images-na.ssl-images-amazon.com https://platform.twitter.com *.twimg.com https://syndication.twitter.com data: https://files.kuula.io disqus.com disquscdn.com *.disqus.com *.disquscdn.com; 
object-src 'none'; 
style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://use.fontawesome.com https://fonts.googleapis.com https://www.google.com https://platform.twitter.com *.twimg.com disqus.com disquscdn.com *.disqus.com *.disquscdn.com; 
script-src 'self' 'unsafe-inline' https://gist.github.com https://platform.twitter.com https://cdn.syndication.twimg.com *.amazon-adsystem.com https://www.google-analytics.com https://cdn.jsdelivr.net cse.google.com https://www.google.com https://pagead2.googlesyndication.com https://adservice.google.com https://www.googletagservices.com jsfiddle.net www.instagram.com disqus.com disquscdn.com *.disqus.com *.disquscdn.com;">
<title>Monitoring | RTFM DevOps</title>


<link rel="stylesheet" href="/book.min.89885fa0429ec73067282f26fc0c6d38cfc617a443ec4e835d47b821c52c6e92.css" integrity="sha256-iYhfoEKexzBnKC8m/AxtOM/GF6RD7E6DXUe4IcUsbpI=">


<script defer src="/search.min.3471bcaff2748c94ac902466d950fd045deda1cd4b577496b311be8c36949a87.js" integrity="sha256-NHG8r/J0jJSskCRm2VD9BF3toc1LV3SWsxG&#43;jDaUmoc="></script>



<link rel="icon" href="/favicon.png" type="image/x-icon">


<!--
Made with rtfm template
https://github.com/denzalman/rtfm-template
-->
  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav>

<h2 class="book-brand">
  <a href="https://rtfmdev.github.io/"><img src="/rtfm.png" alt="Logo" /><span>RTFM DevOps</span>
  </a>
</h2>

<div class="book-search">
  <input type="text" placeholder="Search" id="book-search-input" maxlength="64" readonly />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>




    

  
  





 
  
    

  <ul>
    
      
        

  <li >
    
      

  <a href="/docs/docker/" >
      Docker
  </a>


    

    

  <ul>
    
      
        <li>

  <a href="/docs/docker/commans/" >
      Useful Tips
  </a>

</li>
      
    
  </ul>


  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/AWS/" >
      A W S
  </a>


    

    

  <ul>
    
      
        <li>

  <a href="/docs/AWS/useful-tips/" >
      Useful Tips
  </a>

</li>
      
    
  </ul>


  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/kubernetes/" >
      Kubernetes
  </a>


    

    

  <ul>
    
      
        <li>

  <a href="/docs/kubernetes/kubectl/" >
      Kubectl
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/kubernetes/ingress/" >
      Ingress
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/kubernetes/helm/" >
      Helm
  </a>

</li>
      
    
      
    
      
        <li>

  <a href="/docs/kubernetes/configMaps/" >
      Config Maps
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/kubernetes/monitoring/"  class="active">
      Monitoring
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/kubernetes/networking/" >
      Networking
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/kubernetes/volume_types/" >
      Volume Types
  </a>

</li>
      
    
  </ul>


  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/linux/" >
      Linux
  </a>


    

    

  <ul>
    
  </ul>


  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/devops-tools/" >
      Devops Tools
  </a>


    

    

  <ul>
    
      
        <li>

  <a href="/docs/devops-tools/one-liners/" >
      One Liners
  </a>

</li>
      
    
  </ul>


  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/miscellaneous/" >
      Miscellaneous
  </a>


    

    

  <ul>
    
      
        

  <li >
    
      

  <a href="/docs/miscellaneous/examples/" >
      Examples
  </a>


    

    

  <ul>
    
      
        <li>

  <a href="/docs/miscellaneous/examples/test/" >
      Test
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/miscellaneous/examples/with-toc/" >
      With Table of Contents
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/miscellaneous/examples/without-toc/" >
      Without Table of Contents
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/miscellaneous/examples/shortcodes/" >
      Shortcodes
  </a>

</li>
      
    
  </ul>


  </li>


      
    
      
        <li>

  <a href="/docs/miscellaneous/server/" >
      Server
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/miscellaneous/to-read/" >
      To Read
  </a>

</li>
      
    
  </ul>


  </li>


      
    
  </ul>


  









<a href ="/posts/">Blog</a></br></br>
<a href ="/DenSalmanovCVen.pdf">My CV</a>

</nav>


<script>
(function() {
  var menu = document.querySelector("aside.book-menu nav");
  addEventListener("beforeunload", function(event) {
    localStorage.setItem("menu.scrollTop", menu.scrollTop);
  });
  menu.scrollTop = localStorage.getItem("menu.scrollTop");
})();
</script>
    </aside>

    <div class="book-page">
      <header class="flex align-center justify-between book-header">
  <label for="menu-control">
    <img src="/svg/menu.svg" alt="Menu" />
  </label>
  <strong>Monitoring</strong>
</header>
      
<article class="markdown">

<h2 id="services-monitoring-workflow">Services Monitoring Workflow</h2>

<p>Services Monitoring Workflow consists of three main components:</p>

<pre><code>Collection agent, Metrics Server, and Dashboards. 
</code></pre>

<p>Typical workflow, including most common components:</p>

<ul>
<li>Monitoring agent collects node metrics.</li>
<li>cAdvisor collects containers and pods metrics.</li>
<li>Monitoring Aggregation service collects data from its own agent and cAdvisor.</li>
<li>Data is stored in the monitoring system’s storage.</li>
<li>Monitoring aggregation service exposes metrics through APIs and dashboards.</li>
</ul>

<p><strong>A Few Notes:</strong></p>

<ul>
<li><p>Prometheus is the official monitoring server sponsored and incubated by CNCF. It integrates directly with cAdvisor. You don’t need to install a 3rd party agent to retrieve additional metrics about your containers. However, if you need deeper insights about each node, you need to install an agent of your choice — see Prometheus integrations and third-party exporters page.</p></li>

<li><p>Almost all monitoring systems piggyback on Kubernetes scheduling and orchestration. For example, their agents are installed as DeomonSets and depend on Kubernetes scheduler to have an instance scheduled on each node.</p></li>

<li><p>Most monitoring agents depend on Kubelet to collect container relevant metrics, which in turn depends on cAdvisor. Very few agents collect container relevant details independently.
Most monitoring aggregation services depend on agents pushing metrics to them. Prometheus is an exception. It pulls metrics out of the installed agents.</p></li>
</ul>

<h2 id="what-to-monitor">What to monitor</h2>

<p>Ideal Services Workflow depends on this factors:
- collection of relevant metrics
- perception of continuous changes inside the k8s cluster.</p>

<p>A good pipeline should focus on collecting relevant metrics. There are plenty of agents that can collect OS and process-level metrics. But you will find very few out there that can collect details about containers running at a given node, such as the number of running containers, container state, docker engine metrics, etc. cAdvisor is the best agent for this job.</p>

<p>Perception of continuous changes means that the monitoring pipeline is aware of different pods, containers instances and can relate them to their parent entities, i.e. Deployment, Statefulsets, Namespace, etc. It also means that the metrics server is aware of system-wide metrics that should be visible to users, such as the number of pending pods, nodes status, etc.</p>

<h2 id="tl-dr">TL;DR</h2>

<ul>
<li>You need to differentiate between core metrics pipeline and the services pipeline.</li>
<li>You should pick the best pipeline that works for your needs.</li>
<li>The community official metrics collector tool is Prometheus.</li>
<li>Use <a href="https://github.com/grafana/kubernetes-app">Grafana Dashboards for visualization</a>. But not for alerting.</li>
</ul>
</article>
<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "rtfmdev" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

      
      
    </div>

    
  

  <aside class="book-toc level-3 fixed">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#services-monitoring-workflow">Services Monitoring Workflow</a></li>
<li><a href="#what-to-monitor">What to monitor</a></li>
<li><a href="#tl-dr">TL;DR</a></li>
</ul></li>
</ul>
</nav>
  </aside>


  </main>

  
  
</body>

</html>